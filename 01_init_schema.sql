-- ============================================
-- 진로 검색 프로토타입 - Supabase 스키마
-- ============================================

-- 1. jobs 테이블 생성
CREATE TABLE IF NOT EXISTS jobs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  category TEXT NOT NULL,
  description TEXT,
  salary_min INT,
  salary_max INT,
  outlook TEXT CHECK (outlook IN ('밝음', '보통', '어두움', '매우밝음')),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- 2. 인덱스 생성
CREATE INDEX idx_jobs_category ON jobs(category);
CREATE INDEX idx_jobs_outlook ON jobs(outlook);

-- 3. 확장 & 검색 인덱스 (Korean FTS 미사용)
-- Supabase 기본 이미지엔 'korean' 텍스트 검색 설정이 없습니다.
-- MVP는 ILIKE 기반 검색을 사용하고, 성능을 위해 trigram 인덱스를 사용합니다.
CREATE EXTENSION IF NOT EXISTS pgcrypto;
CREATE EXTENSION IF NOT EXISTS pg_trgm;
CREATE EXTENSION IF NOT EXISTS unaccent;

-- ILIKE 가속을 위한 trigram 인덱스
CREATE INDEX IF NOT EXISTS idx_jobs_name_trgm ON jobs USING GIN (name gin_trgm_ops);
CREATE INDEX IF NOT EXISTS idx_jobs_desc_trgm ON jobs USING GIN (description gin_trgm_ops);

-- 4. RLS 활성화 (읽기만 허용)
ALTER TABLE jobs ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Anyone can read jobs"
  ON jobs FOR SELECT
  USING (true);

-- 5. 더미 데이터 삽입 (50개)
INSERT INTO jobs (name, category, description, salary_min, salary_max, outlook) VALUES
('AI 전문가', 'IT', '머신러닝과 딥러닝 기술을 사용하여 인공지능 모델을 개발하고 학습시키는 업무를 담당합니다. 데이터 분석, 모델 최적화, 알고리즘 개발이 주요 업무입니다.', 5000, 8000, '매우밝음'),
('데이터 분석가', 'IT', '빅데이터를 수집, 분석, 시각화하여 기업의 의사결정에 필요한 인사이트를 제공하는 업무입니다. SQL, Python, Tableau 등의 도구를 사용합니다.', 4500, 7000, '매우밝음'),
('웹 개발자', 'IT', '웹사이트 및 웹앱을 개발하는 업무로, 프론트엔드와 백엔드 개발을 담당합니다. React, Vue, Node.js 등의 기술을 사용합니다.', 4000, 6500, '매우밝음'),
('의료 기술자', '의료', '의료용 기계, 의료장비, 진단 기기 등을 조작하고 유지보수하는 업무입니다. 환자 검사를 돕고 의료 데이터 관리를 합니다.', 3500, 5500, '보통'),
('간호사', '의료', '환자의 의료 서비스 제공, 진료 보조, 환자 케어 및 건강 교육을 담당합니다. 병원, 클리닉, 요양시설 등에서 근무합니다.', 3000, 5000, '매우밝음'),
('목공 기술자', '제조', '나무를 사용하여 가구, 건축 부재, 장식품 등의 제품을 설계하고 제작합니다. 수공구와 기계를 사용하여 정밀한 작업을 수행합니다.', 3000, 4500, '보통'),
('자동차 정비사', '제조', '자동차의 엔진, 변속기, 전기 시스템 등을 점검, 수리, 유지보수합니다. 고객의 차량 문제를 진단하고 해결합니다.', 3000, 4800, '보통'),
('교사', '교육', '학생들을 교육하고 지도하는 업무로, 교과 과정을 계획하고 실행합니다. 초등학교, 중학교, 고등학교, 대학교 등에서 근무합니다.', 3500, 5500, '보통'),
('프로그래머', 'IT', '소프트웨어를 개발하고 유지보수하는 업무입니다. 알고리즘 작성, 코드 리뷰, 버그 수정, 기능 개선 등을 수행합니다.', 4500, 7500, '매우밝음'),
('로봇공학자', '공학', '로봇을 설계, 개발, 제어하는 업무입니다. 산업용 로봇, 서비스 로봇, 의료 로봇 등 다양한 분야에서 근무합니다.', 5000, 8500, '매우밝음'),
('전자기술자', '공학', '전자 회로, 반도체, 전자 부품을 설계하고 제작합니다. 전자제품 개발 및 유지보수 업무를 담당합니다.', 4500, 7000, '보통'),
('건축가', '건설', '건물과 구조물을 설계하고 건설 프로젝트를 관리하는 업무입니다. 건축 기준과 미학적 요구사항을 고려합니다.', 5000, 9000, '보통'),
('토목기술자', '건설', '도로, 교량, 댐, 터널 등 대규모 토목 구조물을 설계하고 시공합니다. 건설 현장에서 공정을 감리하고 관리합니다.', 4500, 7500, '보통'),
('요리사', '조리', '음식을 준비, 조리, 플레이팅하는 업무입니다. 레스토랑, 호텔, 카페 등 다양한 식음료 업체에서 근무합니다.', 2500, 4000, '보통'),
('영양사', '의료', '식단을 계획하고 영양 상담을 제공하는 업무입니다. 병원, 학교, 기업, 요양시설 등에서 근무합니다.', 3000, 4500, '보통'),
('그래픽 디자이너', '디자인', '로고, 포스터, 웹사이트, 광고 등 시각적 디자인을 창작합니다. Adobe Creative Suite, Figma 등의 소프트웨어를 사용합니다.', 3000, 5000, '보통'),
('UX/UI 디자이너', '디자인', '사용자 경험을 중심으로 소프트웨어와 웹 인터페이스를 설계합니다. 사용성, 접근성, 미학을 종합적으로 고려합니다.', 3500, 5500, '매우밝음'),
('금융 분석가', '금융', '재무 데이터를 분석하고 투자 포트폴리오를 관리합니다. 주식, 채권, 펀드 등 금융 상품을 분석하고 조언합니다.', 5000, 9000, '보통'),
('회계사', '금융', '기업의 재무 기록을 관리하고 세무 보고서를 작성합니다. 감시, 감사, 재무 계획 업무를 담당합니다.', 4000, 7000, '보통'),
('변호사', '법률', '법률 자문을 제공하고 소송을 담당합니다. 기업법, 민법, 형법 등 다양한 분야에서 근무합니다.', 6000, 12000, '보통'),
('의사', '의료', '환자를 진찰하고 진단, 치료를 제공합니다. 병원, 클리닉, 보건소 등에서 근무하며 환자 건강을 최우선으로 합니다.', 6000, 15000, '매우밝음'),
('약사', '의료', '의약품을 조제하고 약물 치료 상담을 제공합니다. 약국, 병원, 제약회사 등에서 근무합니다.', 4500, 7000, '보통'),
('심리상담사', '의료', '심리 문제를 가진 사람들을 상담하고 치료합니다. 개인, 집단, 가족 상담 등 다양한 형태의 상담을 제공합니다.', 3500, 5500, '매우밝음'),
('기자', '미디어', '뉴스를 취재하고 작성하여 보도합니다. 신문, 방송, 온라인 미디어 등 다양한 플랫폼에서 근무합니다.', 3500, 5500, '어두움'),
('편집자', '미디어', '원고를 검토하고 편집하여 출판물을 제작합니다. 신문, 잡지, 출판사, 온라인 매체 등에서 근무합니다.', 3500, 5500, '보통'),
('번역가', '교육', '한 언어에서 다른 언어로 텍스트나 음성을 번역합니다. 문학, 기술, 의료, 법률 등 다양한 분야의 번역을 수행합니다.', 3000, 5000, '보통'),
('통역사', '교육', '실시간으로 한 언어를 다른 언어로 통역합니다. 회의, 협상, 여행, 법정 등 다양한 상황에서 근무합니다.', 3500, 5500, '보통'),
('영어 강사', '교육', '영어를 가르치고 학생의 언어 능력을 개발합니다. 학교, 학원, 온라인 플랫폼 등에서 근무합니다.', 3000, 4500, '보통'),
('수학 강사', '교육', '수학을 가르치고 학생의 문제 해결 능력을 개발합니다. 학교, 학원, 온라인 플랫폼 등에서 근무합니다.', 3000, 4500, '보통'),
('과학 강사', '교육', '물리, 화학, 생물 등 과학 과목을 가르칩니다. 실험을 통해 실습 교육을 제공합니다.', 3000, 4500, '보통'),
('음악 강사', '교육', '악기, 성악, 음악 이론을 가르칩니다. 음악 학원, 학교, 온라인 플랫폼 등에서 근무합니다.', 2500, 4000, '보통'),
('미술 강사', '교육', '그림, 조각, 디자인 등 미술을 가르칩니다. 미술 학원, 학교, 문화센터 등에서 근무합니다.', 2500, 4000, '보통'),
('체육 강사', '교육', '운동과 스포츠를 가르치고 학생의 신체 능력을 개발합니다. 학교, 체육관, 스포츠 센터 등에서 근무합니다.', 3000, 4500, '보통'),
('운동 선수', '스포츠', '축구, 농구, 테니스, 수영 등 각종 스포츠 경기에 참가합니다. 전문 팀이나 개인 선수로 활동합니다.', 2000, 10000, '보통'),
('스포츠 코치', '스포츠', '운동 선수들을 훈련하고 지도합니다. 팀 코치, 개인 트레이너로 활동합니다.', 3000, 5000, '보통'),
('산림 관리원', '환경', '산림을 보호하고 관리하는 업무입니다. 산불 예방, 산림 복원, 수목 관리 등을 수행합니다.', 2500, 4000, '보통'),
('환경미화원', '환경', '공공장소와 도시를 깨끗하게 유지하는 업무입니다. 쓰레기 수거, 청소, 환경 미화를 담당합니다.', 2000, 3500, '보통'),
('환경기술자', '환경', '오염 물질을 제거하고 환경을 보호하는 기술을 개발합니다. 수질, 대기, 토양 오염 처리 등을 담당합니다.', 3500, 5500, '매우밝음'),
('농업인', '농업', '곡물, 채소, 과일 등을 재배합니다. 전통 농업부터 첨단 스마트 농업까지 다양한 형태의 농업을 수행합니다.', 2000, 4000, '보통'),
('축산 농민', '농업', '소, 돼지, 닭 등 가축을 사육합니다. 사료 관리, 건강 관리, 위생 관리 등을 담당합니다.', 2000, 4500, '보통'),
('수산업인', '농업', '바다나 강에서 물고기와 해산물을 채취합니다. 어업, 양식, 가공 등 다양한 수산 업무를 수행합니다.', 2500, 4500, '보통'),
('보안 전문가', 'IT', '컴퓨터 시스템과 네트워크를 보호합니다. 사이버 공격 방어, 침투 테스트, 보안 정책 수립 등을 담당합니다.', 5000, 8000, '매우밝음'),
('네트워크 관리자', 'IT', '컴퓨터 네트워크를 설치하고 관리합니다. 서버, 라우터, 방화벽 등의 네트워크 기기를 관리합니다.', 4000, 6500, '보통'),
('데이터베이스 관리자', 'IT', '데이터베이스를 설치, 설정, 운영, 유지보수합니다. 데이터 백업, 보안, 성능 최적화 등을 담당합니다.', 4500, 7000, '매우밝음'),
('IT 지원 담당자', 'IT', '사용자의 IT 문제를 해결하고 기술 지원을 제공합니다. 소프트웨어 설치, 하드웨어 수리, 사용자 교육 등을 담당합니다.', 2500, 4000, '보통'),
('게임 개발자', 'IT', '비디오 게임을 개발하고 프로그래밍합니다. 게임 엔진(Unity, Unreal Engine)을 사용합니다.', 4000, 7000, '매우밝음'),
('앱 개발자', 'IT', '모바일 앱을 개발합니다. iOS, Android 등 다양한 플랫폼에서 앱을 개발하고 배포합니다.', 4500, 7000, '매우밝음'),
('클라우드 엔지니어', 'IT', '클라우드 시스템을 설계하고 관리합니다. AWS, Azure, Google Cloud 등의 플랫폼을 사용합니다.', 5000, 8500, '매우밝음'),
('머신러닝 엔지니어', 'IT', '머신러닝 모델을 개발하고 배포합니다. TensorFlow, PyTorch 등의 라이브러리를 사용합니다.', 5500, 9000, '매우밝음'),
('사이버 보안 분석가', 'IT', '보안 위협을 분석하고 대응합니다. 악성 코드 분석, 침입 탐지, 인시던트 대응 등을 담당합니다.', 5000, 8500, '매우밝음'),
('운영 담당자', '제조', '공장이나 시설의 전반적인 운영을 관리합니다. 생산 일정, 품질 관리, 안전 관리 등을 담당합니다.', 3500, 5500, '보통'),
('품질 관리원', '제조', '제품의 품질을 검사하고 관리합니다. 생산된 제품이 기준을 충족하는지 확인합니다.', 3000, 4500, '보통'),
('영업사원', '영업', '제품을 판매하고 고객 관계를 관리합니다. 목표 달성을 위해 영업 활동을 수행합니다.', 2500, 5000, '보통'),
('마케팅 담당자', '영업', '제품이나 서비스를 홍보하고 마케팅 캠페인을 진행합니다. 디지털 마케팅, 광고, 홍보 등을 담당합니다.', 3500, 5500, '보통'),
('HR 담당자', '인사', '채용, 교육, 급여, 복리후생 등 인사 관련 업무를 담당합니다. 직원 관리와 조직 문화 발전에 기여합니다.', 3000, 5000, '보통'),
('프로젝트 매니저', '경영', '프로젝트의 계획, 실행, 모니터링, 종료를 관리합니다. 팀을 이끌고 목표 달성을 책임집니다.', 4500, 7500, '보통');

-- 데이터 삽입 확인
SELECT COUNT(*) as total_jobs FROM jobs;
